{
  "dataset_info": {
    "platform": "snowflake",
    "name": "final_customer_data",
    "env": "PROD",
    "description": "Final customer data for business consumption",
    "source": "Data Warehouse",
    "data_type": "final"
  },
  "schema": {
    "schemaName": "snowflake.final_customer_data",
    "platform": "urn:li:dataPlatform:snowflake",
    "fields": [
      {
        "fieldPath": "customer_id",
        "type": {"type": "VARCHAR"},
        "description": "Final customer identifier for business use",
        "nullable": false
      },
      {
        "fieldPath": "customer_name",
        "type": {"type": "VARCHAR"},
        "description": "Standardized customer name for business consumption",
        "nullable": true
      },
      {
        "fieldPath": "email_encrypted",
        "type": {"type": "VARCHAR"},
        "description": "Encrypted email address for secure storage",
        "nullable": true
      },
      {
        "fieldPath": "phone_masked",
        "type": {"type": "VARCHAR"},
        "description": "Masked phone number for privacy compliance",
        "nullable": true
      },
      {
        "fieldPath": "customer_segment",
        "type": {"type": "VARCHAR"},
        "description": "Customer segment based on registration year analysis",
        "nullable": true
      },
      {
        "fieldPath": "data_quality_score",
        "type": {"type": "DECIMAL"},
        "description": "Data quality score for the customer record",
        "nullable": true
      }
    ]
  },
  "profile": {
    "rowCount": 4800,
    "columnCount": 6,
    "sizeInBytes": 43200,
    "lastModified": null
  },
  "sample_data": [
    {
      "customer_id": "CUST001",
      "customer_name": "John Smith",
      "email_encrypted": "encrypted_a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456",
      "phone_masked": "***-***-4567",
      "customer_segment": "GROWING",
      "data_quality_score": 0.95
    },
    {
      "customer_id": "CUST002",
      "customer_name": "Jane Doe",
      "email_encrypted": "encrypted_b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef1234567890",
      "phone_masked": "***-***-6543",
      "customer_segment": "ESTABLISHED",
      "data_quality_score": 0.92
    },
    {
      "customer_id": "CUST003",
      "customer_name": "Bob Johnson",
      "email_encrypted": "encrypted_c3d4e5f6789012345678901234567890abcdef1234567890abcdef1234567890ab",
      "phone_masked": "***-***-7890",
      "customer_segment": "NEW",
      "data_quality_score": 0.88
    },
    {
      "customer_id": "CUST004",
      "customer_name": "Alice Brown",
      "email_encrypted": "encrypted_d4e5f6789012345678901234567890abcdef1234567890abcdef1234567890abcd",
      "phone_masked": "***-***-6540",
      "customer_segment": "LEGACY",
      "data_quality_score": 0.85
    },
    {
      "customer_id": "CUST005",
      "customer_name": "Charlie Wilson",
      "email_encrypted": "encrypted_e5f6789012345678901234567890abcdef1234567890abcdef1234567890abcdef",
      "phone_masked": "***-***-0123",
      "customer_segment": "NEW",
      "data_quality_score": 0.91
    }
  ],
  "transformations": {
    "customer_name": {
      "type": "STANDARDIZATION",
      "input_columns": ["full_name"],
      "description": "Standardize customer name format",
      "config": {"case": "TITLE", "removeExtraSpaces": true}
    },
    "email_encrypted": {
      "type": "ENCRYPTION",
      "input_columns": ["email_hash"],
      "description": "Encrypt hashed email using AES-256",
      "config": {"algorithm": "AES-256", "keyRotation": "monthly"}
    },
    "phone_masked": {
      "type": "MASKING",
      "input_columns": ["phone_clean"],
      "description": "Mask phone number showing only last 4 digits",
      "config": {"maskType": "PHONE", "showLast": 4}
    },
    "customer_segment": {
      "type": "CLASSIFICATION",
      "input_columns": ["registration_year"],
      "description": "Classify customer segment based on registration year",
      "config": {
        "rules": {
          "2020-2021": "NEW",
          "2018-2019": "GROWING",
          "2015-2017": "ESTABLISHED",
          "default": "LEGACY"
        }
      }
    },
    "data_quality_score": {
      "type": "SCORING",
      "input_columns": ["customer_id", "full_name", "email_hash", "phone_clean", "registration_year"],
      "description": "Calculate data quality score based on completeness and validity",
      "config": {"weights": {"completeness": 0.4, "validity": 0.6}}
    }
  }
}
